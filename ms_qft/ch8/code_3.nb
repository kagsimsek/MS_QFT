(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     21653,        646]
NotebookOptionsPosition[     20345,        617]
NotebookOutlinePosition[     20741,        633]
CellTagsIndexPosition[     20698,        630]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "NotOperatorQ", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotOperatorQ", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FreeQ", "[", 
      RowBox[{"x", ",", "a"}], "]"}], "&&", 
     RowBox[{"FreeQ", "[", 
      RowBox[{"x", ",", "A"}], "]"}]}], ",", "True", ",", "False"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.836269005740052*^9, 3.83626903752046*^9}, {
  3.836269072257456*^9, 3.836269082101021*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"004cc7ba-0dab-431c-a92e-e97781e8a664"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "M", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"L___", ",", 
    RowBox[{"a_", "+", "b_"}], ",", "R___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"M", "[", 
    RowBox[{"L", ",", "a", ",", "R"}], "]"}], "+", 
   RowBox[{"M", "[", 
    RowBox[{"L", ",", "b", ",", "R"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"L___", ",", 
    RowBox[{
     RowBox[{"a_", "?", "NumericQ"}], " ", "b_"}], ",", "R___"}], "]"}], ":=", 
  RowBox[{"a", " ", 
   RowBox[{"M", "[", 
    RowBox[{"L", ",", "b", ",", "R"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"L___", ",", 
    RowBox[{
     RowBox[{"a_", "?", "NotOperatorQ"}], " ", "b_"}], ",", "R___"}], "]"}], ":=", 
  RowBox[{"a", " ", 
   RowBox[{"M", "[", 
    RowBox[{"L", ",", "b", ",", "R"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"L___", ",", 
    RowBox[{"-", "a_"}], ",", "R___"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"M", "[", 
    RowBox[{"L", ",", "a", ",", "R"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"L___", ",", 
    RowBox[{"a", "[", "k1_", "]"}], ",", 
    RowBox[{"A", "[", "k2_", "]"}], ",", "R___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "Pi"}], ")"}], "^", "3"}], " ", "2", 
    RowBox[{"\[Omega]", "[", "k1", "]"}], 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"k1", ",", "k2"}], "]"}], 
    RowBox[{"M", "[", 
     RowBox[{"L", ",", "R"}], "]"}]}], "+", 
   RowBox[{"M", "[", 
    RowBox[{"L", ",", 
     RowBox[{"A", "[", "k2", "]"}], ",", 
     RowBox[{"a", "[", "k1", "]"}], ",", "R"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"L___", ",", 
    RowBox[{"a", "[", "k1_", "]"}], ",", 
    RowBox[{"B", "[", "k2_", "]"}], ",", "R___"}], "]"}], ":=", 
  RowBox[{"M", "[", 
   RowBox[{"L", ",", 
    RowBox[{"B", "[", "k2", "]"}], ",", 
    RowBox[{"a", "[", "k1", "]"}], ",", "R"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"L___", ",", 
    RowBox[{"b", "[", "k1_", "]"}], ",", 
    RowBox[{"a", "[", "k2_", "]"}], ",", "R___"}], "]"}], ":=", 
  RowBox[{"M", "[", 
   RowBox[{"L", ",", 
    RowBox[{"a", "[", "k2", "]"}], ",", 
    RowBox[{"b", "[", "k1", "]"}], ",", "R"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"L___", ",", 
    RowBox[{"b", "[", "k1_", "]"}], ",", 
    RowBox[{"A", "[", "k2_", "]"}], ",", "R___"}], "]"}], ":=", 
  RowBox[{"M", "[", 
   RowBox[{"L", ",", 
    RowBox[{"A", "[", "k2", "]"}], ",", 
    RowBox[{"b", "[", "k1", "]"}], ",", "R"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"L___", ",", 
    RowBox[{"b", "[", "k1_", "]"}], ",", 
    RowBox[{"B", "[", "k2_", "]"}], ",", "R___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "Pi"}], ")"}], "^", "3"}], " ", "2", 
    RowBox[{"\[Omega]", "[", "k1", "]"}], 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"k1", ",", "k2"}], "]"}], 
    RowBox[{"M", "[", 
     RowBox[{"L", ",", "R"}], "]"}]}], "+", 
   RowBox[{"M", "[", 
    RowBox[{"L", ",", 
     RowBox[{"B", "[", "k2", "]"}], ",", 
     RowBox[{"b", "[", "k1", "]"}], ",", "R"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"L___", ",", 
    RowBox[{"B", "[", "k1_", "]"}], ",", 
    RowBox[{"A", "[", "k2_", "]"}], ",", "R___"}], "]"}], ":=", 
  RowBox[{"M", "[", 
   RowBox[{"L", ",", 
    RowBox[{"A", "[", "k2", "]"}], ",", 
    RowBox[{"B", "[", "k1", "]"}], ",", "R"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"L___", ",", 
    RowBox[{"Q_", "[", 
     RowBox[{"k", "[", "j_", "]"}], "]"}], ",", 
    RowBox[{"Q_", "[", 
     RowBox[{"k", "[", "i_", "]"}], "]"}], ",", "R___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"M", "[", 
    RowBox[{"L", ",", 
     RowBox[{"Q", "[", 
      RowBox[{"k", "[", "i", "]"}], "]"}], ",", 
     RowBox[{"Q", "[", 
      RowBox[{"k", "[", "j", "]"}], "]"}], ",", "R"}], "]"}], "/;", 
   RowBox[{"j", ">", "i"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"L___", ",", 
    RowBox[{"a", "[", "k_", "]"}]}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"L___", ",", 
    RowBox[{"b", "[", "k_", "]"}]}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{
    RowBox[{"A", "[", "k_", "]"}], ",", "R___"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{
    RowBox[{"B", "[", "k_", "]"}], ",", "R___"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "/:", 
   RowBox[{"M", "[", "]"}], "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.836268963569714*^9, 3.836269004315495*^9}, {
  3.836269086641811*^9, 3.836269151417794*^9}, {3.836269257071198*^9, 
  3.8362692881903467`*^9}, {3.836327731997183*^9, 3.836327840254591*^9}, {
  3.8363278932191677`*^9, 3.8363279360655117`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"9b386c55-b071-4d3f-a4bc-058d656e0e89"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "Contract", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Contract", "[", "expr_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "dum", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dum", "[", "1", "]"}], "=", 
      RowBox[{"expr", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dum", "[", "2", "]"}], "=", 
      RowBox[{
       RowBox[{"dum", "[", "1", "]"}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"d3k", "[", "b_", "]"}], 
         RowBox[{"\[Delta]", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "fac_"}], ":>", 
        RowBox[{
         RowBox[{
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"b", "->", "a"}], "]"}], "[", "fac", "]"}], "/;", 
         RowBox[{"!", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"fac", ",", "b"}], "]"}]}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dum", "[", "3", "]"}], "=", 
      RowBox[{
       RowBox[{"dum", "[", "2", "]"}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"d3k", "[", "b_", "]"}], 
         RowBox[{"\[Delta]", "[", 
          RowBox[{"b_", ",", "a_"}], "]"}], "fac_"}], ":>", 
        RowBox[{
         RowBox[{
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"b", "->", "a"}], "]"}], "[", "fac", "]"}], "/;", 
         RowBox[{"!", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"fac", ",", "b"}], "]"}]}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"dum", "[", "3", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.836269345651959*^9, 3.8362693906188183`*^9}, {
  3.8362695794411*^9, 3.836269614163384*^9}, {3.836269659352606*^9, 
  3.836269660777033*^9}, {3.8362697276517553`*^9, 3.836269729345441*^9}, {
  3.836270131833091*^9, 3.836270134996643*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"832bebc1-f97b-4d5e-949a-f0b2ea43f7d6"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"d", ",", "f", ",", "exp"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "[", "k_", "]"}], ":=", 
  FractionBox[
   RowBox[{"d3k", "[", "k", "]"}], 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "Pi"}], ")"}], "^", "3"}], " ", "2", 
    RowBox[{"\[Omega]", "[", "k", "]"}]}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"x_", ",", "t_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"d", "[", "k", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "k", "]"}], 
      RowBox[{"exp", "[", 
       RowBox[{"$I", " ", "k", " ", "x"}], "]"}], 
      RowBox[{"exp", "[", 
       RowBox[{
        RowBox[{"-", "$I"}], " ", 
        RowBox[{"\[Omega]", "[", "k", "]"}], "t"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"B", "[", "k", "]"}], 
      RowBox[{"exp", "[", 
       RowBox[{
        RowBox[{"-", "$I"}], " ", "k", " ", "x"}], "]"}], 
      RowBox[{"exp", "[", 
       RowBox[{"$I", " ", 
        RowBox[{"\[Omega]", "[", "k", "]"}], "t"}], "]"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{"x_", ",", "t_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"d", "[", "k", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"b", "[", "k", "]"}], 
      RowBox[{"exp", "[", 
       RowBox[{"$I", " ", "k", " ", "x"}], "]"}], 
      RowBox[{"exp", "[", 
       RowBox[{
        RowBox[{"-", "$I"}], " ", 
        RowBox[{"\[Omega]", "[", "k", "]"}], "t"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "k", "]"}], 
      RowBox[{"exp", "[", 
       RowBox[{
        RowBox[{"-", "$I"}], " ", "k", " ", "x"}], "]"}], 
      RowBox[{"exp", "[", 
       RowBox[{"$I", " ", 
        RowBox[{"\[Omega]", "[", "k", "]"}], "t"}], "]"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exp", "[", "0", "]"}], "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.836269153229418*^9, 3.836269197422002*^9}, {
   3.8362692970918703`*^9, 3.836269330534253*^9}, {3.836269479043664*^9, 
   3.8362695247484627`*^9}, {3.836269562058874*^9, 3.836269572964882*^9}, 
   3.8362696560923233`*^9, 3.836269733468961*^9, 3.836270139095902*^9, {
   3.8363277131676617`*^9, 3.8363277239428596`*^9}, {3.836329313233046*^9, 
   3.8363293168928556`*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"aa21d083-ee00-414b-9658-13470d53d5a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Contract", "[", 
        RowBox[{"M", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"x", ",", "t", ",", 
            RowBox[{"k", "[", "1", "]"}]}], "]"}], ",", 
          RowBox[{"f", "[", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"k", "[", "_", "]"}], "->", "k"}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"exp", "[", 
         RowBox[{"$I", " ", "k", " ", "x"}], "]"}], 
        RowBox[{"exp", "[", 
         RowBox[{
          RowBox[{"-", "$I"}], " ", 
          RowBox[{"\[Omega]", "[", "k", "]"}], "t"}], "]"}]}], "->", 
       RowBox[{"exp", "[", 
        RowBox[{"$I", " ", 
         RowBox[{"k", ".", "x"}]}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"d3k", "[", "k_", "]"}], ":>", 
      RowBox[{
       RowBox[{"HoldForm", "[", 
        RowBox[{"d", "[", "k", "]"}], "]"}], "2", 
       RowBox[{"\[Omega]", "[", "k", "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "Pi"}], ")"}], "^", "3"}]}]}]}], ")"}], 
   RowBox[{"\[Theta]", "[", "t", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Contract", "[", 
        RowBox[{"M", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"k", "[", "1", "]"}]}], "]"}], ",", 
          RowBox[{"f", "[", 
           RowBox[{"x", ",", "t", ",", 
            RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"k", "[", "_", "]"}], "->", "k"}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"exp", "[", 
         RowBox[{
          RowBox[{"-", "$I"}], " ", "k", " ", "x"}], "]"}], 
        RowBox[{"exp", "[", 
         RowBox[{"$I", " ", 
          RowBox[{"\[Omega]", "[", "k", "]"}], "t"}], "]"}]}], "->", 
       RowBox[{"exp", "[", 
        RowBox[{
         RowBox[{"-", "$I"}], " ", 
         RowBox[{"k", ".", "x"}]}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"d3k", "[", "k_", "]"}], ":>", 
      RowBox[{
       RowBox[{"HoldForm", "[", 
        RowBox[{"d", "[", "k", "]"}], "]"}], "2", 
       RowBox[{"\[Omega]", "[", "k", "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "Pi"}], ")"}], "^", "3"}]}]}]}], ")"}], 
   RowBox[{"\[Theta]", "[", 
    RowBox[{"-", "t"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.83629849797852*^9, 3.836298522561359*^9}, {
  3.836298566500486*^9, 3.8362986170623713`*^9}, {3.83632796792248*^9, 
  3.8363279889068937`*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"3f2e8be0-f84b-4223-94a5-280b025e035b"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.83632798999988*^9, 3.8363280017745523`*^9}, 
   3.836329317708291*^9},
 CellLabel->
  "Out[163]=",ExpressionUUID->"c8b2d6f4-647e-498f-a07e-fcb64dbfee38"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Contract", "[", 
        RowBox[{"M", "[", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{"x", ",", "t", ",", 
            RowBox[{"k", "[", "1", "]"}]}], "]"}], ",", 
          RowBox[{"F", "[", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"k", "[", "_", "]"}], "->", "k"}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"exp", "[", 
         RowBox[{"$I", " ", "k", " ", "x"}], "]"}], 
        RowBox[{"exp", "[", 
         RowBox[{
          RowBox[{"-", "$I"}], " ", 
          RowBox[{"\[Omega]", "[", "k", "]"}], "t"}], "]"}]}], "->", 
       RowBox[{"exp", "[", 
        RowBox[{"$I", " ", 
         RowBox[{"k", ".", "x"}]}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"d3k", "[", "k_", "]"}], ":>", 
      RowBox[{
       RowBox[{"HoldForm", "[", 
        RowBox[{"d", "[", "k", "]"}], "]"}], "2", 
       RowBox[{"\[Omega]", "[", "k", "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "Pi"}], ")"}], "^", "3"}]}]}]}], ")"}], 
   RowBox[{"\[Theta]", "[", "t", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Contract", "[", 
        RowBox[{"M", "[", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"k", "[", "1", "]"}]}], "]"}], ",", 
          RowBox[{"F", "[", 
           RowBox[{"x", ",", "t", ",", 
            RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"k", "[", "_", "]"}], "->", "k"}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"exp", "[", 
         RowBox[{
          RowBox[{"-", "$I"}], " ", "k", " ", "x"}], "]"}], 
        RowBox[{"exp", "[", 
         RowBox[{"$I", " ", 
          RowBox[{"\[Omega]", "[", "k", "]"}], "t"}], "]"}]}], "->", 
       RowBox[{"exp", "[", 
        RowBox[{
         RowBox[{"-", "$I"}], " ", 
         RowBox[{"k", ".", "x"}]}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"d3k", "[", "k_", "]"}], ":>", 
      RowBox[{
       RowBox[{"HoldForm", "[", 
        RowBox[{"d", "[", "k", "]"}], "]"}], "2", 
       RowBox[{"\[Omega]", "[", "k", "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "Pi"}], ")"}], "^", "3"}]}]}]}], ")"}], 
   RowBox[{"\[Theta]", "[", 
    RowBox[{"-", "t"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.83629849797852*^9, 3.836298522561359*^9}, {
  3.836298566500486*^9, 3.8362986170623713`*^9}, {3.83632796792248*^9, 
  3.8363279995344276`*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"221a341d-d565-4e86-94e0-8dce779e0ad6"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.836327999929035*^9, 3.836328001875255*^9}, 
   3.836329317736827*^9},
 CellLabel->
  "Out[164]=",ExpressionUUID->"f74a47a7-246e-454a-b85a-5033799f9882"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Contract", "[", 
        RowBox[{"M", "[", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{"x", ",", "t", ",", 
            RowBox[{"k", "[", "1", "]"}]}], "]"}], ",", 
          RowBox[{"f", "[", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"k", "[", "_", "]"}], "->", "k"}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"exp", "[", 
         RowBox[{"$I", " ", "k", " ", "x"}], "]"}], 
        RowBox[{"exp", "[", 
         RowBox[{
          RowBox[{"-", "$I"}], " ", 
          RowBox[{"\[Omega]", "[", "k", "]"}], "t"}], "]"}]}], "->", 
       RowBox[{"exp", "[", 
        RowBox[{"$I", " ", 
         RowBox[{"k", ".", "x"}]}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"d3k", "[", "k_", "]"}], ":>", 
      RowBox[{
       RowBox[{"HoldForm", "[", 
        RowBox[{"d", "[", "k", "]"}], "]"}], "2", 
       RowBox[{"\[Omega]", "[", "k", "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "Pi"}], ")"}], "^", "3"}]}]}]}], ")"}], 
   RowBox[{"\[Theta]", "[", "t", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Contract", "[", 
        RowBox[{"M", "[", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"k", "[", "1", "]"}]}], "]"}], ",", 
          RowBox[{"f", "[", 
           RowBox[{"x", ",", "t", ",", 
            RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"k", "[", "_", "]"}], "->", "k"}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"exp", "[", 
         RowBox[{
          RowBox[{"-", "$I"}], " ", "k", " ", "x"}], "]"}], 
        RowBox[{"exp", "[", 
         RowBox[{"$I", " ", 
          RowBox[{"\[Omega]", "[", "k", "]"}], "t"}], "]"}]}], "->", 
       RowBox[{"exp", "[", 
        RowBox[{
         RowBox[{"-", "$I"}], " ", 
         RowBox[{"k", ".", "x"}]}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"d3k", "[", "k_", "]"}], ":>", 
      RowBox[{
       RowBox[{"HoldForm", "[", 
        RowBox[{"d", "[", "k", "]"}], "]"}], "2", 
       RowBox[{"\[Omega]", "[", "k", "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "Pi"}], ")"}], "^", "3"}]}]}]}], ")"}], 
   RowBox[{"\[Theta]", "[", 
    RowBox[{"-", "t"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.83629849797852*^9, 3.836298522561359*^9}, {
  3.836298566500486*^9, 3.8362986170623713`*^9}, {3.83632796792248*^9, 
  3.836327973379951*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"e0490791-d644-430a-a111-c1754289734c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"exp", "[", 
    RowBox[{
     RowBox[{"-", "$I"}], " ", 
     RowBox[{"k", ".", "x"}]}], "]"}], " ", 
   TagBox[
    RowBox[{"d", "[", "k", "]"}],
    HoldForm], " ", 
   RowBox[{"\[Theta]", "[", 
    RowBox[{"-", "t"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"exp", "[", 
    RowBox[{"$I", " ", 
     RowBox[{"k", ".", "x"}]}], "]"}], " ", 
   TagBox[
    RowBox[{"d", "[", "k", "]"}],
    HoldForm], " ", 
   RowBox[{"\[Theta]", "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.83632797377671*^9, 3.836328001985231*^9}, 
   3.8363293177620983`*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"d7563a80-195b-4e1c-a9ee-be57ae4da067"]
}, Open  ]]
},
WindowSize->{1090.5, 711.75},
WindowMargins->{{6, Automatic}, {4.5, Automatic}},
FrontEndVersion->"12.3 for Linux x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c209c9b3-d8c4-434e-bf94-1c45a7d5498f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 586, 15, 51, "Input",ExpressionUUID->"004cc7ba-0dab-431c-a92e-e97781e8a664"],
Cell[1147, 37, 5202, 153, 360, "Input",ExpressionUUID->"9b386c55-b071-4d3f-a4bc-058d656e0e89"],
Cell[6352, 192, 2035, 53, 174, "Input",ExpressionUUID->"832bebc1-f97b-4d5e-949a-f0b2ea43f7d6"],
Cell[8390, 247, 2436, 70, 133, "Input",ExpressionUUID->"aa21d083-ee00-414b-9658-13470d53d5a9"],
Cell[CellGroupData[{
Cell[10851, 321, 2769, 82, 92, "Input",ExpressionUUID->"3f2e8be0-f84b-4223-94a5-280b025e035b"],
Cell[13623, 405, 204, 4, 33, "Output",ExpressionUUID->"c8b2d6f4-647e-498f-a07e-fcb64dbfee38"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13864, 414, 2769, 82, 92, "Input",ExpressionUUID->"221a341d-d565-4e86-94e0-8dce779e0ad6"],
Cell[16636, 498, 203, 4, 33, "Output",ExpressionUUID->"f74a47a7-246e-454a-b85a-5033799f9882"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16876, 507, 2767, 82, 92, "Input",ExpressionUUID->"e0490791-d644-430a-a111-c1754289734c"],
Cell[19646, 591, 683, 23, 56, "Output",ExpressionUUID->"d7563a80-195b-4e1c-a9ee-be57ae4da067"]
}, Open  ]]
}
]
*)

